<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Main Functions · MvSim.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MvSim.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MvSim.jl</a></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../pearson_matching/">Pearson Matching</a></li><li><a class="tocitem" href="../nearest_correlation_matrix/">Nearest Correlation Matrix</a></li></ul></li><li class="is-active"><a class="tocitem" href>Main Functions</a><ul class="internal"><li><a class="tocitem" href="#Random-Multivariate-Vector"><span>Random Multivariate Vector</span></a></li><li><a class="tocitem" href="#Correlations"><span>Correlations</span></a></li><li><a class="tocitem" href="#Pearson-Matching"><span>Pearson Matching</span></a></li></ul></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><a class="tocitem" href="../details/">Details</a></li><li><a class="tocitem" href="../function_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Main Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Main Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/adknudson/MvSim.jl/blob/master/docs/src/main_functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Main-Functions"><a class="docs-heading-anchor" href="#Main-Functions">Main Functions</a><a id="Main-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Functions" title="Permalink"></a></h1><h2 id="Random-Multivariate-Vector"><a class="docs-heading-anchor" href="#Random-Multivariate-Vector">Random Multivariate Vector</a><a id="Random-Multivariate-Vector-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Multivariate-Vector" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MvSim.MvDistribution" href="#MvSim.MvDistribution"><code>MvSim.MvDistribution</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Multivariate mixed distribution</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L23">source</a></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MvSim.rvec-Tuple{Int64,Array{Float64,2},Array{var&quot;#s35&quot;,1} where var&quot;#s35&quot;&lt;:(Distribution{Univariate,S} where S&lt;:ValueSupport)}" href="#MvSim.rvec-Tuple{Int64,Array{Float64,2},Array{var&quot;#s35&quot;,1} where var&quot;#s35&quot;&lt;:(Distribution{Univariate,S} where S&lt;:ValueSupport)}"><code>MvSim.rvec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">rvec(n::Int, ρ::Matrix{Float64}, margins::Vector{&lt;:UnivariateDistribution})</code></pre><p>Generate samples for a list of marginal distributions and a correaltion structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/rand_vec.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rand(D::MvDistribution, n::Int)</code></pre><p>More general wrapper for <code>rvec</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/rand_vec.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.margins-Tuple{MvDistribution}" href="#MvSim.margins-Tuple{MvDistribution}"><code>MvSim.margins</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">margins(D::MvDistribution)</code></pre><p>Return the margins of the multivariate distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L33-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Statistics.cor-Tuple{MvDistribution}" href="#Statistics.cor-Tuple{MvDistribution}"><code>Statistics.cor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">cor(D::MvDistribution)</code></pre><p>Return the correlation matrix of the multivariate distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L38-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cortype-Tuple{MvDistribution}" href="#MvSim.cortype-Tuple{MvDistribution}"><code>MvSim.cortype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">cortype(D::MvDistribution)</code></pre><p>Return the correlation matrix type of the multivariate distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L43-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.eltype-Tuple{MvDistribution}" href="#Base.eltype-Tuple{MvDistribution}"><code>Base.eltype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">eltype(D::MvDistribution)</code></pre><p>Return the eltype of the correlation matrix of the multivariate distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L48-L51">source</a></section></article><h2 id="Correlations"><a class="docs-heading-anchor" href="#Correlations">Correlations</a><a id="Correlations-1"></a><a class="docs-heading-anchor-permalink" href="#Correlations" title="Permalink"></a></h2><h3 id="Types-2"><a class="docs-heading-anchor" href="#Types-2">Types</a><a class="docs-heading-anchor-permalink" href="#Types-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MvSim.Pearson" href="#MvSim.Pearson"><code>MvSim.Pearson</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Pearson &lt;: Correlation</code></pre><p>Pearson&#39;s <span>$r$</span> product-moment correlation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.Spearman" href="#MvSim.Spearman"><code>MvSim.Spearman</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Spearman &lt;: Correlation</code></pre><p>Spearman&#39;s <span>$ρ$</span> rank correlation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.Kendall" href="#MvSim.Kendall"><code>MvSim.Kendall</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Kendall &lt;: Correlation</code></pre><p>Kendall&#39;s <span>$τ$</span> rank correlation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/MvDistribution.jl#L14-L18">source</a></section></article><h3 id="Estimating"><a class="docs-heading-anchor" href="#Estimating">Estimating</a><a id="Estimating-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="Statistics.cor" href="#Statistics.cor"><code>Statistics.cor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor(x[, y], ::Type{&lt;:Correlation})</code></pre><p>Compute the correlation matrix of a given type. </p><p>The possible correlation types are:</p><ul><li><a href="#MvSim.Pearson"><code>Pearson</code></a></li><li><a href="#MvSim.Spearman"><code>Spearman</code></a></li><li><a href="#MvSim.Kendall"><code>Kendall</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; x = [-1.62169     0.0158613   0.500375  -0.794381
             2.50689     3.31666    -1.3049     2.16058
             0.495674    0.348621   -0.614451  -0.193579
             2.32149     2.18847    -1.83165    2.08399
            -0.0573697   0.39908     0.270117   0.658458
             0.365239   -0.321493   -1.60223   -0.199998
            -0.55521    -0.898513    0.690267   0.857519
            -0.356979   -1.03724     0.714859  -0.719657
            -3.38438    -1.93058     1.77413   -1.23657
             1.57527     0.836351   -1.13275   -0.277048];

julia&gt; cor(x, Pearson)
4×4 Array{Float64,2}:
  1.0        0.86985   -0.891312   0.767433
  0.86985    1.0       -0.767115   0.817407
 -0.891312  -0.767115   1.0       -0.596762
  0.767433   0.817407  -0.596762   1.0

julia&gt; cor(x, Spearman)
4×4 Array{Float64,2}:
  1.0        0.866667  -0.854545   0.709091
  0.866667   1.0       -0.781818   0.684848
 -0.854545  -0.781818   1.0       -0.612121
  0.709091   0.684848  -0.612121   1.0

julia&gt; cor(x, Kendall)
4×4 Array{Float64,2}:
  1.0        0.733333  -0.688889   0.555556
  0.733333   1.0       -0.688889   0.555556
 -0.688889  -0.688889   1.0       -0.422222
  0.555556   0.555556  -0.422222   1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L1-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_bounds" href="#MvSim.cor_bounds"><code>MvSim.cor_bounds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_bounds(dA::UnivariateDistribution, dB::UnivariateDistribution, C::Type{&lt;:Correlation}=Pearson; n_samples::Int=100_000)</code></pre><p>Compute the stochastic lower and upper correlation bounds between two marginal distributions.</p><p>This method relies on sampling from each distribution and then estimating the specified correlation between the sorted samples. Because the samples are random, there will be some variation in the answer for each call to <code>cor_bounds</code>. Increasing the number of samples will increase the accuracy of the estimate, but will also take longer to sort. Therefore ≈100,000 samples (the default) are recommended so that it runs fast while still returning a good estimate.</p><p>The possible correlation types are:</p><ul><li><a href="#MvSim.Pearson"><code>Pearson</code></a></li><li><a href="#MvSim.Spearman"><code>Spearman</code></a></li><li><a href="#MvSim.Kendall"><code>Kendall</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; A = Normal(78, 10); B = LogNormal(3, 1);

julia&gt; cor_bounds(A, B)
(lower = -0.7646512417819491, upper = 0.7649206069306482)

julia&gt; cor_bounds(A, B, n_samples=Int(1e9))
(lower = -0.7629776825238167, upper = 0.7629762333824238)

julia&gt; cor_bounds(A, B, n_samples=Int(1e4))
(lower = -0.7507010142250724, upper = 0.7551879647701095)

julia&gt; cor_bounds(A, B, Spearman)
(lower = -1.0, upper = 1.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L213-L249">source</a></section><section><div><pre><code class="language-none">cor_bounds(D::MvDistribution; n_samples::Int=100_000)</code></pre><p>Compute the pairwise stochastic lower and upper correlation bounds between all marginal distributions.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; margins = [Normal(78, 10), LogNormal(3, 1)];

julia&gt; r = [1.0 0.6; 0.6 1.0]
2×2 Array{Float64,2}:
 1.0  0.6
 0.6  1.0

julia&gt; D = MvDistribution(r, margins, Pearson);

julia&gt; bounds = cor_bounds(D);

julia&gt; bounds.lower
2×2 Array{Float64,2}:
  1.0      -0.76892
 -0.76892   1.0

julia&gt; bounds.upper
2×2 Array{Float64,2}:
 1.0       0.768713
 0.768713  1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L266-L297">source</a></section></article><h3 id="Generating"><a class="docs-heading-anchor" href="#Generating">Generating</a><a id="Generating-1"></a><a class="docs-heading-anchor-permalink" href="#Generating" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_randPSD" href="#MvSim.cor_randPSD"><code>MvSim.cor_randPSD</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_randPSD([T::Type{&lt;:AbstractFloat}], d::Int[, k::Int=d])</code></pre><p>Return a random positive semidefinite correlation matrix.</p><p>See also: <a href="#MvSim.cor_randPD"><code>cor_randPD</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; cor_randPSD(4)
4×4 Array{Float64,2}:
  1.0        0.81691   -0.27188    0.289011
  0.81691    1.0       -0.44968    0.190938
 -0.27188   -0.44968    1.0       -0.102597
  0.289011   0.190938  -0.102597   1.0

julia&gt; cor_randPSD(4, 1)
4×4 Array{Float64,2}:
  1.0       -0.800513   0.541379  -0.650587
 -0.800513   1.0       -0.656411   0.788824
  0.541379  -0.656411   1.0       -0.533473
 -0.650587   0.788824  -0.533473   1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/random.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_randPD" href="#MvSim.cor_randPD"><code>MvSim.cor_randPD</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_randPD([T::Type{&lt;:AbstractFloat}], d::Int[, k::Int=d])</code></pre><p>The same as <a href="#MvSim.cor_randPSD"><code>cor_randPSD</code></a>, but calls <a href="#MvSim.cor_fastPD"><code>cor_fastPD</code></a> to ensure that the returned matrix is positive definite.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; cor_randPSD(4)
4×4 Array{Float64,2}:
  1.0        0.356488   0.701521  -0.251671
  0.356488   1.0        0.382787  -0.117748
  0.701521   0.382787   1.0       -0.424952
 -0.251671  -0.117748  -0.424952   1.0

julia&gt; cor_randPSD(4, 1)
4×4 Array{Float64,2}:
  1.0        -0.0406469  -0.127517  -0.133308
 -0.0406469   1.0         0.265604   0.277665
 -0.127517    0.265604    1.0        0.871089
 -0.133308    0.277665    0.871089   1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/random.jl#L42-L64">source</a></section></article><h3 id="Converting"><a class="docs-heading-anchor" href="#Converting">Converting</a><a id="Converting-1"></a><a class="docs-heading-anchor-permalink" href="#Converting" title="Permalink"></a></h3><p>Convert a correlation matrix by finding a positive [semi]definite representation.</p><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_nearPD" href="#MvSim.cor_nearPD"><code>MvSim.cor_nearPD</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_nearPD(R::Matrix{Float64}[, τ::Float64=1e-6[, tol::Float64=1e-6]])</code></pre><p>Return the nearest positive definite correlation matrix to <code>R</code>.</p><p>See also: <a href="#MvSim.cor_fastPD"><code>cor_fastPD</code></a>, <a href="#MvSim.cor_fastPD!"><code>cor_fastPD!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; import LinearAlgebra: isposdef

julia&gt; r = [1.00 0.82 0.56 0.44; 0.82 1.00 0.28 0.85; 0.56 0.28 1.00 0.22; 0.44 0.85 0.22 1.00]
4×4 Array{Float64,2}:
 1.0   0.82  0.56  0.44
 0.82  1.0   0.28  0.85
 0.56  0.28  1.0   0.22
 0.44  0.85  0.22  1.0

julia&gt; isposdef(r)
false

julia&gt; r̃ = cor_nearPD(r)
4×4 Array{Float64,2}:
 1.0       0.817494  0.559416  0.441494
 0.817494  1.0       0.280852  0.847812
 0.559416  0.280852  1.0       0.21949
 0.441494  0.847812  0.21949   1.0

julia&gt; isposdef(r̃)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/nearest_pos_def.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_fastPD" href="#MvSim.cor_fastPD"><code>MvSim.cor_fastPD</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_fastPD(R::Matrix{&lt;:AbstractFloat}[, τ=1e-6])</code></pre><p>Return a positive definite correlation matrix that is close to <code>R</code>.</p><p>See also: <a href="#MvSim.cor_fastPD!"><code>cor_fastPD!</code></a>, <a href="#MvSim.cor_nearPD"><code>cor_nearPD</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; import LinearAlgebra: isposdef

julia&gt; r = [1.00 0.82 0.56 0.44; 0.82 1.00 0.28 0.85; 0.56 0.28 1.00 0.22; 0.44 0.85 0.22 1.00]
4×4 Array{Float64,2}:
 1.0   0.82  0.56  0.44
 0.82  1.0   0.28  0.85
 0.56  0.28  1.0   0.22
 0.44  0.85  0.22  1.0

julia&gt; isposdef(r)
false

julia&gt; r̃ = cor_fastPD(r)
4×4 Array{Float64,2}:
 1.0       0.817095  0.559306  0.440514
 0.817095  1.0       0.280196  0.847352
 0.559306  0.280196  1.0       0.219582
 0.440514  0.847352  0.219582  1.0

julia&gt; isposdef(r̃)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/fast_pos_def.jl#L80-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_fastPD!" href="#MvSim.cor_fastPD!"><code>MvSim.cor_fastPD!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_fastPD!(R::Matrix{&lt;:AbstractFloat}[, τ=1e-6])</code></pre><p>Same as <a href="#MvSim.cor_fastPD"><code>cor_fastPD</code></a>, but saves space by overwriting the input <code>R</code>, instead of creating a copy.</p><p>See also: <a href="#MvSim.cor_fastPD"><code>cor_fastPD</code></a>, <a href="#MvSim.cor_nearPD"><code>cor_nearPD</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; import LinearAlgebra: isposdef

julia&gt; r = [1.00 0.82 0.56 0.44; 0.82 1.00 0.28 0.85; 0.56 0.28 1.00 0.22; 0.44 0.85 0.22 1.00]
4×4 Array{Float64,2}:
 1.0   0.82  0.56  0.44
 0.82  1.0   0.28  0.85
 0.56  0.28  1.0   0.22
 0.44  0.85  0.22  1.0

julia&gt; isposdef(r)
false

julia&gt; cor_fastPD!(r)
4×4 Array{Float64,2}:
 1.0       0.817095  0.559306  0.440514
 0.817095  1.0       0.280196  0.847352
 0.559306  0.280196  1.0       0.219582
 0.440514  0.847352  0.219582  1.0

julia&gt; isposdef(r)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/fast_pos_def.jl#L29-L61">source</a></section></article><p>Convert a correlation matrix using other utilities.</p><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_convert" href="#MvSim.cor_convert"><code>MvSim.cor_convert</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_convert(R::Matrix{&lt;:AbstractFloat}, from::Type{&lt;:Correlation}, to::Type{&lt;:Correlation})</code></pre><p>Convert from one type of correlation matrix to another.</p><p>The role of conversion in this package is typically used from either Spearman or  Kendall to Pearson where the Pearson correlation is used in the generation of random multivariate normal samples. After converting, the correlation matrix may not be positive semidefinite, so it is recommended to check using  <code>LinearAlgebra.isposdef</code>, and subsequently calling <a href="#MvSim.cor_nearPD"><code>cor_nearPD</code></a>.</p><p>See also: <a href="#MvSim.cor_nearPD"><code>cor_nearPD</code></a>, <a href="#MvSim.cor_fastPD"><code>cor_fastPD</code></a></p><p>The possible correlation types are:</p><ul><li><a href="#MvSim.Pearson"><code>Pearson</code></a></li><li><a href="#MvSim.Spearman"><code>Spearman</code></a></li><li><a href="#MvSim.Kendall"><code>Kendall</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; r = [ 1.0       -0.634114   0.551645   0.548993
            -0.634114   1.0       -0.332105  -0.772114
             0.551645  -0.332105   1.0        0.143949
             0.548993  -0.772114   0.143949   1.0];

julia&gt; cor_convert(r, Pearson, Spearman)
4×4 Array{Float64,2}:
  1.0       -0.616168   0.533701   0.531067
 -0.616168   1.0       -0.318613  -0.756979
  0.533701  -0.318613   1.0        0.13758
  0.531067  -0.756979   0.13758    1.0

julia&gt; cor_convert(r, Spearman, Kendall)
4×4 Array{Float64,2}:
  1.0       -0.452063   0.385867    0.383807
 -0.452063   1.0       -0.224941   -0.576435
  0.385867  -0.224941   1.0         0.0962413
  0.383807  -0.576435   0.0962413   1.0

julia&gt; r == cor_convert(r, Pearson, Pearson)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L56-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cov2cor" href="#MvSim.cov2cor"><code>MvSim.cov2cor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cov2cor(C::Matrix{&lt;:AbstractFloat})</code></pre><p>Transform a covariance matrix into a correlation matrix.</p><p><strong>Details</strong></p><p>If <span>$X \in \mathbb{R}^{n \times n}$</span> is a covariance matrix, then</p><p class="math-container">\[\tilde{X} = D^{-1/2} X  D^{-1/2}, \quad D = \mathrm{diag(X)}\]</p><p>is the associated correlation matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L177-L191">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cov2cor!" href="#MvSim.cov2cor!"><code>MvSim.cov2cor!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cov2cor!(C::Matrix{&lt;:AbstractFloat})</code></pre><p>Same as <a href="#MvSim.cov2cor"><code>cov2cor</code></a>, except that the matrix <code>C</code> is updated in place to save memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L199-L204">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_constrain" href="#MvSim.cor_constrain"><code>MvSim.cor_constrain</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_constrain(C::Matrix{&lt;:AbstractFloat}[, uplo=:U])</code></pre><p>Constrain a matrix so that its diagonal elements are 1, off-diagonal elements are bounded between -1 and 1, and a symmetric view of the upper (if <code>uplo = :U</code>) or lower (if <code>uplo = :L</code>) triangle is made.</p><p>See also: <a href="#MvSim.cor_constrain!"><code>cor_constrain!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; a = [ 0.802271   0.149801  -1.1072     1.13451
             0.869788  -0.824395   0.38965    0.965936
            -1.45353   -1.29282    0.417233  -0.362526
             0.638291  -0.682503   1.12092   -1.27018];

julia&gt; cor_constrain(a)
4×4 Array{Float64,2}:
  1.0       0.149801  -1.0        1.0
  0.149801  1.0        0.38965    0.965936
 -1.0       0.38965    1.0       -0.362526
  1.0       0.965936  -0.362526   1.0

julia&gt; cor_constrain(a, :L)
4×4 Array{Float64,2}:
  1.0        0.869788  -1.0   0.638291
  0.869788   1.0       -1.0  -0.682503
 -1.0       -1.0        1.0   1.0
  0.638291  -0.682503   1.0   1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L142-L172">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.cor_constrain!" href="#MvSim.cor_constrain!"><code>MvSim.cor_constrain!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cor_constrain!(C::Matrix{&lt;:AbstractFloat}[, uplo=:U])</code></pre><p>Same as <a href="#MvSim.cor_constrain"><code>cor_constrain</code></a>, except that the matrix <code>C</code> is updated in place to save memory.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; a = [ 0.802271   0.149801  -1.1072     1.13451
             0.869788  -0.824395   0.38965    0.965936
            -1.45353   -1.29282    0.417233  -0.362526
             0.638291  -0.682503   1.12092   -1.27018];

julia&gt; cor_constrain!(a)

julia&gt; a
4×4 Array{Float64,2}:
  1.0       0.149801  -1.0        1.0
  0.149801  1.0        0.38965    0.965936
 -1.0       0.38965    1.0       -0.362526
  1.0       0.965936  -0.362526   1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/Correlation/utils.jl#L110-L132">source</a></section></article><h2 id="Pearson-Matching"><a class="docs-heading-anchor" href="#Pearson-Matching">Pearson Matching</a><a id="Pearson-Matching-1"></a><a class="docs-heading-anchor-permalink" href="#Pearson-Matching" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MvSim.pearson_match" href="#MvSim.pearson_match"><code>MvSim.pearson_match</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pearson_match(ρ::Real, dA::UnivariateDistribution, dB::UnivariateDistribution; n::Int=7)</code></pre><p>Compute the pearson correlation coefficient that is necessary to achieve the target correlation given a pair of marginal distributions.</p><p>See also: <a href="#MvSim.pearson_bounds"><code>pearson_bounds</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; A = Normal(78, 10); B = LogNormal(3, 1);

julia&gt; pearson_match(0.76, A, B)
0.9962326957691602</code></pre><p>The target correlation may not be feasible (see <a href="#MvSim.pearson_bounds"><code>pearson_bounds</code></a>), in  which case the match to the nearest lower or upper bound is returned.</p><pre><code class="language-julia-repl">julia&gt; pearson_match(0.9, A, B)
┌ Warning: The target correlation is not feasible. Returning the match to the nearest bound instead.
[...]
0.9986891675055749</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/PearsonMatching/pearson_match.jl#L1-L28">source</a></section><section><div><pre><code class="language-none">pearson_match(D::MvDistribution; n::Int=7)</code></pre><p>Return a MvDistribution type with the matched Pearson correlation coefficients and the Pearson correlation type.</p><p>If the input correlation matrix is anything other than <code>Pearson</code>, then convert it to Pearson, perform the matching algorithm, and then finally ensure that the resulting correlation matrix is positive definite. The target correlation may  not be feasible (see <a href="#MvSim.pearson_bounds"><code>pearson_bounds</code></a>), in which case the match to the  nearest lower or upper bound is returned.</p><p>See also: <a href="#MvSim.pearson_bounds"><code>pearson_bounds</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; margins = [Normal(78, 10), LogNormal(3, 1)];

julia&gt; r = [1.0 0.7; 0.7 1.0]
2×2 Array{Float64,2}:
 1.0  0.7
 0.7  1.0

julia&gt; D = MvDistribution(r, margins, Spearman);

julia&gt; R = pearson_match(D);

julia&gt; cor(R)
2×2 Array{Float64,2}:
 1.0       0.917583
 0.917583  1.0

julia&gt; cortype(R)
Pearson</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/PearsonMatching/pearson_match.jl#L142-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MvSim.pearson_bounds" href="#MvSim.pearson_bounds"><code>MvSim.pearson_bounds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pearson_bounds(dA::UnivariateDistribution, dB::UnivariateDistribution, μA, μB, σA, σB; n::Int=7)</code></pre><p>Compute the theoretical lower and upper Pearson correlation values for a pair of  univariate distributions.</p><p>See also: <a href="#MvSim.pearson_match"><code>pearson_match</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; A = Normal(78, 10); B = LogNormal(3, 1);

julia&gt; pearson_bounds(A, B)
(lower = -0.7628739783665699, upper = 0.7628739783663034)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/PearsonMatching/pearson_bounds.jl#L1-L18">source</a></section><section><div><pre><code class="language-none">pearson_bounds(D::MvDistribution)</code></pre><p>Compute the pairwise theoretical lower and upper Pearson correlation values for a set of univariate distributions. The correlation matrix and correlation type are ignored when using this function on the <code>MvDistribution</code> type.</p><p>See also: <a href="#MvSim.pearson_match"><code>pearson_match</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; using Distributions

julia&gt; margins = [Normal(78, 10), LogNormal(3, 1)];

julia&gt; r = [1.0 0.7; 0.7 1.0]
2×2 Array{Float64,2}:
 1.0  0.7
 0.7  1.0

julia&gt; D = MvDistribution(r, margins, Pearson);

julia&gt; bounds = pearson_bounds(D);

julia&gt; bounds.lower
2×2 Array{Float64,2}:
  1.0       -0.762874
 -0.762874   1.0

julia&gt; bounds.upper
2×2 Array{Float64,2}:
 1.0       0.762874
 0.762874  1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/adknudson/MvSim.jl/blob/9ff073fb14e34b9a02db9017d676ad1a19800fec/src/PearsonMatching/pearson_bounds.jl#L42-L76">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nearest_correlation_matrix/">« Nearest Correlation Matrix</a><a class="docs-footer-nextpage" href="../utilities/">Utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 5 January 2021 23:23">Tuesday 5 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
